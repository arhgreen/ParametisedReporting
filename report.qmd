---
title: "Parametised Financial Reporting"
author: "Aaron H. Green"
date: "2025-02-26"
format:
  html:
    pdf:
      toc: true
    toc-location: left
    html-math-method: katex
execute: 
  warning: false
  error: false
  echo: false

css: styles.css
---
\newpage

## Introduction

This report provides a detailed financial analysis of our company's branches across different regions.

## Financial Data Overview

```{r}
library(tibble)
library(dplyr)
library(knitr)

# Load data
df <- read.csv('financial_data.csv')

kable(head(df), format = "pipe")
```

## Parameterized Reports by Branch

```{r, results='asis', echo=FALSE, results='asis'}
branches <- unique(df$Branch)
for (branch in branches) {
  cat("## Branch: ", branch, "\n\n")
  
  branch_data <- df %>% filter(Branch == branch)
  
  cat("### Balance Sheet\n")
  balance_sheet <- branch_data %>%
    group_by(Year) %>%
    summarise(
      Total_Assets = sum(Assets),
      Total_Liabilities = sum(Liabilities),
      Total_Equity = sum(Equity)
    )
  print(kable(balance_sheet, format = "pipe"))
  cat("\n")
  
  cat("### Income Statement\n")
  income_statement <- branch_data %>%
    group_by(Year) %>%
    summarise(
      Total_Revenue = sum(Revenue),
      Sales = sum(Sales),
      Investments = sum(Investments),
      Other_Income = sum(Other_Income),
      Total_Expenses = sum(Expenses),
      Salaries = sum(Salaries),
      Rent = sum(Rent),
      Utilities = sum(Utilities),
      Other_Expenses = sum(Other_Expenses),
      Net_Income = sum(Revenue) - sum(Expenses)
    )
  print(kable(income_statement, format = "pipe"))
  cat("\n")
  
  cat("### Cash Flow Statement\n")
  cash_flow_statement <- branch_data %>%
    group_by(Year) %>%
    summarise(
      Operating_CashFlow = sum(Operating_CashFlow),
      Investing_CashFlow = sum(Investing_CashFlow),
      Financing_CashFlow = sum(Financing_CashFlow),
      Total_CashFlow = sum(CashFlow)
    )
  print(kable(cash_flow_statement, format = "pipe"))
  cat("\n")
}
```